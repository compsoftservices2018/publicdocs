<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% if page.title and page.title != site.title %}{{ page.title }} — {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
    <meta name="description" content="{{ page.description | default: site.description }}">
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
  </head>
  <body>

    <header class="site-header">
      <div class="container">
        <div class="brand">
          <a href="{{ '/' | relative_url }}">{{ site.title }}</a>
          <span class="tagline">{{ site.description }}</span>
        </div>
        <nav class="main-nav" aria-label="Main navigation">
          {% for item in site.nav_links %}
            <a href="{{ item.url | relative_url }}">{{ item.title }}</a>{% unless forloop.last %} · {% endunless %}
          {% endfor %}
        </nav>
      </div>
    </header>

    <main class="site-main container">
      <div class="markdown-body">
        {{ content }}
      </div>
    </main>

    <footer class="site-footer">
      <div class="container">© {{ site.title }}</div>
    </footer>

    {% if page.mermaid %}
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });

      // This part is crucial because Jekyll creates <code class="language-mermaid">
      // but Mermaid looks for <div class="mermaid">
      document.addEventListener('DOMContentLoaded', function () {
        const blocks = document.querySelectorAll('pre code.language-mermaid');
        blocks.forEach(block => {
          const div = document.createElement('div');
          div.className = 'mermaid';
          div.textContent = block.textContent;
          block.parentElement.replaceWith(div);
        });
        mermaid.init(undefined, '.mermaid');
      });
    </script>
    {% endif %}
  </body>
</html>

